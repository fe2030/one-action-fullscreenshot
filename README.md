# One Action Fullscreenshot

ワンクリックまたはショートカットキーでWebページ全体のスクリーンショットを撮影し、クリップボードにコピーまたは保存するChrome拡張機能です。

## 特徴 (Features)

- **ワンアクション撮影**: 拡張機能アイコンをクリック、またはショートカットキー (`Alt` + `Shift` + `F`) を押すだけで撮影開始。
- **フルページキャプチャ**: 画面外の領域も含めてページ全体を自動スクロールして撮影します。
- **スマートな結合処理**: スクロール時の重複部分を自動で検出し、1枚の画像に綺麗に結合します。
- **スティッキー要素の制御**: ヘッダーなどの追従要素（`position: fixed/sticky`）が重複して写り込まないよう自動で制御します。
- **クリップボード連携**: 撮影した画像を自動的にクリップボードにコピーします（PNG形式）。
- **自動保存フォールバック**: 画像サイズが大きすぎてクリップボードに入らない場合や、設定で「ダウンロード」を選択した場合は、自動的にファイルとして保存します。
- **カスタマイズ可能**:
  - **Action Type**: 撮影後の動作を「クリップボードにコピー」か「ファイルをダウンロード」から選択可能。
  - **File Format**: 保存形式を PNG または JPEG から選択可能（クリップボードモードはPNGのみ）。

## インストール方法 (Installation)

この拡張機能は現在Chromeウェブストアには公開されていないため、以下の手順で「パッケージ化されていない拡張機能」としてインストールしてください。

1. **リポジトリのクローンまたはダウンロード**
   ```bash
   git clone https://github.com/your-username/one-action-fullscreenshot.git
   # またはZIPをダウンロードして解凍
   ```

2. **Chrome拡張機能管理ページを開く**
   - Chromeのアドレスバーに `chrome://extensions/` と入力してエンターキーを押します。

3. **デベロッパーモードを有効化**
   - 画面右上の「デベロッパーモード (Developer mode)」トグルスイッチをオンにします。

4. **拡張機能を読み込む**
   - 左上に表示される「パッケージ化されていない拡張機能を読み込む (Load unpacked)」ボタンをクリックします。
   - 手順1でダウンロード（解凍）したフォルダ（`manifest.json` が含まれているフォルダ）を選択します。

5. **完了**
   - 拡張機能リストに "One Action Fullscreenshot" が追加されればインストール完了です。
   - ツールバーにアイコンをピン留めしておくと便利です。

## 使い方 (Usage)

### スクリーンショットを撮る

以下のいずれかの方法で撮影を開始できます：

1. **アイコンクリック**: Chromeツールバーのカメラアイコンをクリックします。
2. **ショートカットキー**: `Alt` + `Shift` + `F` (Windows/Mac共通) を押します。
   - ※ショートカットキーは `chrome://extensions/shortcuts` から変更可能です。

撮影が始まると画面上にオーバーレイが表示され、自動スクロールが行われます。撮影中はマウス操作を控えてください。

### 設定を変更する

1. 拡張機能アイコンを右クリックし、「オプション (Options)」を選択します。
2. 設定画面が開きます。
   - **Action Type**:
     - `Copy to Clipboard` (Default): クリップボードにコピーします。
     - `Download File`: ファイルとしてダウンロードフォルダに保存します。
   - **File Format**:
     - `PNG` (Default): 高画質ですがサイズが大きくなります。
     - `JPEG`: ファイルサイズを抑えられます（ダウンロードモード時のみ選択可能）。

## 技術スタック (Tech Stack)

- **Manifest V3**: 最新のChrome拡張機能仕様に準拠。
- **JavaScript (Vanilla)**: フレームワークを使用せず、軽量・高速に動作。
- **Chrome APIs**:
  - `activeTab`: 現在のタブへのアクセス権限。
  - `scripting`: コンテンツスクリプトの注入。
  - `tabs.captureVisibleTab`: 表示領域のキャプチャ。
  - `downloads`: 画像ファイルの保存。
  - `storage`: ユーザー設定の保存。

## ディレクトリ構成 (Directory Structure)

```
.
├── manifest.json      # 拡張機能の定義ファイル (Manifest V3)
├── background.js      # イベントハンドリング、画像処理、ダウンロード制御
├── content.js         # ページ内スクロール、UI表示、クリップボード処理
├── options.html       # 設定画面のHTML
├── options.js         # 設定画面のロジック
├── options.css        # 設定画面のスタイル
└── icons/             # アプリアイコン
    ├── icon16.png
    ├── icon48.png
    └── icon128.png
```

## 注意事項 (Notes)

- `chrome://` や `edge://` などのブラウザシステムページ、およびChromeウェブストアのページでは、セキュリティ制限によりスクリーンショットを撮影できません。
- 非常に長いページの場合、メモリ制限により撮影に失敗するか、分割して保存される場合があります。
- Windowsのクリップボード履歴（Win+V）には4MBのサイズ制限があるため、大きな画像は履歴に残らない場合があります（直近の貼り付けは可能です）。

## License

MIT License